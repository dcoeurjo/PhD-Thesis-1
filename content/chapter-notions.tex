% !TEX root = ../thesis-example.tex
%
\chapter{Notions et éléments de base de la géométrie digitale}
\label{sec:notions}

\cleanchapterquote{We have seen that computer programming is an art, because it applies accumulated knowledge to the world, because it requires skill and ingenuity, and especially because it produces objects of beauty.}{Jean-Claude Vandamme}{Ma vie, mon œuvre.}

\setcounter{minitocdepth}{3}
\minitoc

\newpage

\section{Discrétisation}
%
\section{Estimateurs locaux et globaux}
%
\section{Convergence asymptotique d'estimateurs}
%
\section{Introduction à la géométrie différentielle}
%
\section{Droites discrètes, segments discrets}
%
\begin{definition}[Standard Line and Digital Straight Segment (DSS)]
  The set of points $(x,y)\in\Z^2$ satisfying $\mu \le ax - by < \mu +
  |a| + |b|$, with $a$, $b$ and $\mu$ integer numbers, is called the
  {\em standard digital line} with slope $a/b$ and shift $\mu$.  Any
  connected subset of pixels of a standard digital line is a
  \emph{digital straight segment} (DSS for short).
\end{definition}
%
\begin{definition}[Segments maximaux et faisceau de segments maximaux \cite{lachaud2007-ivc}]
  Une séquence de pointels $\{p_i,\ldots,p_j\}\subset\BdZ{Z}$ est un {\em
    segment maximal} \ssi $\{p_i,\ldots,p_j\}$ est un DSS qui ne peux s'étendre dans aucun sens (en avant ou en arrière) tout en restant DSS.
    Pour un pointel $p\in\BdZ{Z}$, le \emph{faisceau de segments maximaux} à $p$ est l'ensemble des segments maximaux de $\BdZ{Z}$ contenant $p$.
\end{definition}
%
\begin{lemma}[Lois asymptotiques des segments maximaux \cite{lachaud2006-hdr,deVieilleville2007-jmiv}]
  \label{lem-asymptotic-digital-length-ms}
   Soit $X$ une forme convexe de $\R^2$, avec \emph{au moins} une
   bordure $C^3$  et une courbure bornée.  La longueur discrète des
   segments maximaux de $\BdZ{Z}$ pour $Z=\DSh$ suivent les règles suivantes :
   \begin{itemize}
   \item le plus court des segments discrets a une borne inférieure en
     $\Omega(h^{-\frac{1}{3}})$;
   \item le plus long des segments discrets a une borne supérieure en
     $O(h^{-\frac{1}{2}})$;
   \item leur longueur moyenne, désigné par $L_D({Z})$, est telle que :
  \begin{equation}
    \label{eq:lengthMS}
    \Theta(h^{-\frac{1}{3}}) \le L_D( {Z} ) \le \Theta(h^{-\frac{1}{3}} \log \left(\frac{1}{h}\right))\;.
  \end{equation}
   \end{itemize}
\end{lemma}
%
\section{Estimateurs digitaux d'aire, de volume, de moments, de positionnement de surface}
%
\subsection{Aire et volume digitaux}
%
\subsubsection{Aire et volume en comptant les points digitaux}
\label{sec:AreaByCounting}
Une façon simple de calculer l'aire ou le volume d'une forme digitale consiste à
compter le nombre de points digitaux appartenant à la forme. Plus formellement,
pour tout sous-ensemble $\DigShape \subset \Z^2$, l'estimateur digital d'aire au pas
de discrétisation $h$ est défini par :
%
\begin{equation}
  \AreaC(\DigShape, h) \EqDef h^2 \MCard(\DigShape)
\end{equation}
%
En dimension $3$, nous noterons l'estimateur digital de volume au pas de
discrétisation $h$ :
%
\begin{equation}
  \VolC(\DigShape, h) \EqDef h^3 \MCard(\DigShape)
\end{equation}
%
Maintenant, si ce sous-ensemble digital $\DigShape$ provient de la discrétisation de
formes euclidiennes $\Shape$, nous voulons que l'estimation du volume devienne
meilleure lorsque le pas de discrétisation $h$ se raffine (voir
\RefSection{sec:notion:multigridconvergence}). Il est connu depuis
\nauthor{Gauss} et \nauthor{Dirichlet} que cette façon d'estimer l'aire donne
des résultats de convergence asymptotique sur les formes $\Shape$ convexes
finies de $\R^2$ :
%
\begin{equation}
  \label{eq:AreaByCountingConv}
  \AreaC(\DigF{\Shape}{h},h) = \Area(\Shape) + O(h^\beta),
\end{equation}
%
avec $\beta = 1$ dans le cas général \cite{Klette2000}, et peut être optimisé à
$\beta = \frac{15}{11} - \epsilon$ avec $\epsilon > 0$ (arbitrairement petit)
lorsque le bord de l'objet est $C^3$ à courbure non nulle \cite{Huxley1990}.
De mêmes résultats ont été proposés en 3D :
%
\begin{equation}
  \label{eq:VolumeByCountingConv}
  \VolC(\DigF{\Shape}{h},h) = \Vol(\Shape) + O(h^\gamma),
\end{equation}
%
avec $\gamma = 1$ dans le cas général \cite{Kratzel1988}, et peut être amélioré à
$\gamma=\frac{243}{158}$ lorsque le bord est lisse \cite{Guo2010}.
%
En dimension 2, les objets non convexes suivent les mêmes règles tant que
$\Shape$ peut être exprimé comme une somme ou une différence de régions convexes
bornées par des courbes fermées simples \cite{Huxley1996}. Ces résultats
précédents restent valides chaque fois que le bord de la forme peut être
décomposé en nombre fini de morceaux convexes (ou convexe $C^3$ à courbure non
nulle pour les bornes améliorées).
%
\subsection{Moments géométriques digitaux}
%
Le concept mathématique des moments a beaucoup été étudié depuis plusieurs
années et trouve son champ d'application sans cesse augmenté, allant des
statistiques et mécaniques (\anglais{General moment theory}) \cite{} à la
reconnaissance de formes (\cauthors{Trier}{Trier1996} pour un survey sur la
reconnaissance de caractères, \cite{}) et la reconstruction d'objets \cite{Ghorbel2005}.
La première utilisation des moments en analyse d'images remonte à 1962 par
\cauthor{Hu}{Hu1962} pour la reconnaissance de caractères.
%
Les moments ont l'avantage d'être indépendant à l'échelle, la position et l'orientation, en faisant un outil invariant robuste \cite{}. Nous allons tout d'abord définir ce que sont les moments et leurs caractéristiques, pour ensuite nous intéresser à les estimer sur des données digitales.
%
\todoJeremy{Le papier Reconstructing With Geometric Moments \cite{Ghorbel2005} est pas mal niveau intro}
%
\subsubsection{Définition et propriétés des moments géométriques}
%
Une définition générale du moment géométrique (ou moment cartésien) $\Mom{p_1 \cdots p_d}$ d'ordre $p_1 \cdots p_d$ (aussi appelé le $p_1 \cdots p_d$-moment) de $\Shape$ (de $\R^d$) peut être donnée comme :
%
\begin{equation}
  \Mom{p_1 \cdots p_d}(\Shape) \EqDef \idotsint_{\Shape} x_1^{p_1} \cdots x_d^{p_d} f(x_1 \cdots x_d) dx_1 \ldots dx_d.
\end{equation}
%
\paragraph{Moment d'ordre zéro : aire / volume}
%
Il apparaît alors que le $0\cdots0$-moment correspond à l'aire en 2D ou au volume en 3D de $\Shape$ :
%
\begin{equation}
  \Mom{0 \cdots 0}(\Shape) \EqDef \idotsint_{\Shape} f(x_1 \cdots x_d) dx_1 \ldots dx_d.
\end{equation}
%
\paragraph{Moments du premier ordre : barycentre}
%
Les $d$ moments du premier ordre ($\Mom{1 0 \cdots 0}(\Shape)$, $\Mom{0 1 0 \cdots 0}(\Shape)$, $\cdots$, $\Mom{0 \cdots 0 1}(\Shape)$) sont généralement utilisés pour déterminer le barycentre de la forme à analyser. Les coordonnées du barycentre $(\overline{x_1}, \cdots, \overline{x_p})$ sont :
%
\begin{equation}
  \overline{x_1} = \frac{\Mom{1 0 \cdots 0}(\Shape)}{\Mom{0 \cdots 0}(\Shape)}, \cdots, \overline{x_p} = \frac{\Mom{0 \cdots 0 1}(\Shape)}{\Mom{0 \cdots 0}(\Shape)}.
\end{equation}
%
\paragraph{Moments du second ordre}
%
Les moments du second ordre $\Mom{p_1 \cdots p_d}(\Shape)$ avec $p_1 + \cdots +
p_2 = 2$ sont connus comme les moments d'inertie, caractérisant la géométrie des
masses de la forme. En 2D, nous en dénombrons 3 : $\Mom{2 0}(\Shape)$, $\Mom{1
1}(\Shape)$ et $\Mom{0 2}(\Shape)$, en 3D il en existe 6 :  $\Mom{2 0
0}(\Shape)$, $\Mom{0 2 0}(\Shape)$, $\Mom{0 0 2}(\Shape)$, $\Mom{1 1
0}(\Shape)$, $\Mom{0 1 0}(\Shape)$ et $\Mom{1 0 1}(\Shape)$
%
\subsubsection{Moments en comptant les points digitaux}
%
Comme pour l'aire ou le volume précédemment, il est très simple de calculer les
moments sur des données digitales. En effet, il suffit de sommer les valeurs des
points digitaux de la forme et de remettre à l'échelle suivant le pas de
discrétisation $h$. Plus formellement, pour tout sous-ensemble $\DigShape$ de
$\Z^d$, le $p_1 \cdots p_d$-moment digital de $\DigShape$ au pas de
discrétisation $h$ est défini par :
%
\begin{equation}
  \DMom{p_1 \cdots p_d}{h}(\DigShape) \EqDef h^{d + p_1 + \cdots + p_d} \sum_{(z_1,\ldots,z_d) \in \DigShape} z_1^{p_1} \cdots z_d^{p_d} f(z_1^{p_1} \cdots z_d^{p_d}).
\end{equation}
%
Il est à noter que $f(z_1 \cdots z_d)$ est tout le temps égal à $1$ lorsque
$(z_1,\ldots,z_d) \in \DigShape$, $0$ sinon, nous pouvons alors l'enlever de
l'équation :
%
\begin{equation}
  \DMom{p_1 \cdots p_d}{h}(\DigShape) \EqDef h^{d + p_1 + \cdots + p_d} \sum_{(z_1,\ldots,z_d) \in \DigShape} z_1^{p_1} \cdots z_d^{p_d}.
\end{equation}
% %
% Ainsi, soit $\vz \in \Z^d$, les moments digitaux sont alors :
% %
% \begin{align}
%   \DMom{0 \cdots 0}{h}(\DigShape, h) &= h^d\\
%   \DMom{1 0 \cdots 0}{h}(\DigShape, h) &= h^{d+1} z_1\\
%   \DMom{1 1 0 \cdots 0}{h}(\DigShape, h) &= h^{d+2} z_1 z_2\\
%   \DMom{2 0 \cdots 0}{h}(\DigShape, h) &= h^{d+2} z_1^2.
% \end{align}
%
%
\todoInlineJeremy{-----------------------------------------------------------------}
%
\begin{equation}
  \label{huxleylike}
  \hat{m}_{p,q,s}(\DigF{Y}{h},h)= m_{p,q,s}(Y) + O(h^{\mu_{{\sigma}}}).
\end{equation}
%
\section{Enveloppes convexes}
%



% MODELE DE BRUIT KANUNGO. (These de Louis)
% Dans le but de valider les resultats theoriques faisant intervenir une hypothese Hausdorff, on definit le modele de bruit Kanungo sur les contours digitaux. Pour une taille de bruit t ∈ N la probabilite qu’un voxel situe a une distance λ de ∂X appartienne au contour bruitee est tλ. Ce n’est pas exactement un bruit Hausdorff, mais la plupart des perturbations se situe dans une bande d’epaisseur 2h/(1−t). Remarquons que le modele Kanungo depend du pas de discretisation h. Plus precisement, plus le pas de discretisation est petit, et plus le bruit est faible. Ce modele est interessant dans la mesure ou il garantit la convergence des contours bruites vers la forme sous-jacente et permet ainsi de faire une etude de convergence multigrille.
